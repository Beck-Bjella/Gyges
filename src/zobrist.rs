use crate::board::*;

use rand::Rng;

pub const PLAYER_1_HASH: u64 = 11071850447646664432;
pub const PLAYER_2_HASH: u64 = 15525846075063937794;

pub const ZOBRIST_HASH_DATA_OLD: [[u64; 4]; 38] = [
    [0, 17271146761489934505, 5731067236955268636, 5440895969528383227],
    [0, 6908161478278069512, 163137166929386689, 5175367257606230099],
    [0, 15678061977278651327, 4342210785954339878, 10421414496350474389],
    [0, 14661329419540667408, 17234345801839241819, 2998267813913182165],
    [0, 8059183300254769393, 7357651304440855062, 11054658478566185969],
    [0, 7628449314179351152, 16011015434632805319, 148065583554297882],
    [0, 1229987243259231315, 11390869921144479046, 13634212619743443691],
    [0, 9002277609415293143, 7505291609172773518, 2795749869949995199],
    [0, 14024593191782177623, 346619833874376748, 837316784079495954],
    [0, 7275908115279280883, 5476518308405771932, 1975962952693434737],
    [0, 11916462295615863549, 7584897348348047417, 15266713858648429521],
    [0, 11582544963026537704, 2480196147949524689, 11145724781135210407],
    [0, 9990059204016401474, 9965965168873497062, 16580232330918035103],
    [0, 13415138415452179598, 17984169603222347424, 9836221046511630859],
    [0, 15386696162757339775, 8229836887638076002, 15564958676316221336],
    [0, 10235491871910816784, 18228667549352045392, 2640796907198133658],
    [0, 8004931756304696722, 14006850199526880928, 6331337265473869091],
    [0, 1827267435045261959, 3952119902210078878, 16197602661720872535],
    [0, 2583716458899523901, 1108094517312941964, 14964724034489818288],
    [0, 1970971818847674737, 18043215342211359609, 15193331934706361660],
    [0, 8871072892014702538, 12723379682769991067, 10865244106060528545],
    [0, 16095147102408176227, 2364783556453971483, 1692362245996406642],
    [0, 4216200426147137458, 17314530674616367644, 3594837015093906520],
    [0, 15494571378229158402, 17174007274985283120, 15189739520631790970],
    [0, 8553487892204388615, 581989376358731934, 7189707411135414010],
    [0, 15800600293061601358, 15226164173696033468, 11642113883550526112],
    [0, 3446548095223110786, 13854454133188603984, 479277857006449989],
    [0, 3738582228039737915, 14281896676812763195, 14817968076821073977],
    [0, 8542197244305336919, 5906334434697062488, 8754468054738541524],
    [0, 8077051619544888191, 11395091612375786452, 14270130577027623690],
    [0, 9300440638072859995, 8758874664715956479, 11106632125981582782],
    [0, 147418120392472299, 12653007631372846489, 13828776562928005692],
    [0, 967328797832502418, 5497992568843233814, 9966202313557282830],
    [0, 2025944389002309580, 17776703105091429050, 17937401315152051457],
    [0, 2155909447216090271, 10093299614224892697, 15876185156277415607],
    [0, 13947070007303465673, 8021398431065744446, 8626671271913755770],
    [0, 9800752891054723046, 2663066954917743220, 6311096048655016704],
    [0, 11965025932495732772, 16399160543532862667, 9978569474538894239],

];

pub const ZOBRIST_HASH_DATA: [[u64; 4]; 38] = [
    [0, 16019584827874668947, 10756861282518694731, 326575046895935871], 
    [0, 10801462851853052059, 8912476932191465120, 4868635385389206586], 
    [0, 6811037796297371929, 5452186390884417396, 6595524892338886420], 
    [0, 9515779292363133931, 4771700775976261681, 7508435081546226485], 
    [0, 13143799653672417594, 2977295878291973880, 12312946028297191917],
    [0, 1170089553000533213, 6764588673318868279, 11275009673257570151], 
    [0, 14594542294030362533, 18177455830854766254, 1901908595772958652], 
    [0, 1159529803391868207, 3970892217229352740, 14785767409178671674], 
    [0, 10999170248432652892, 14229154700594107303, 8307568924959719677], 
    [0, 1666831744467359211, 15273435638547708406, 4625106060006123695], 
    [0, 2527832789102003890, 2162706509636595181, 12274659024403278944], 
    [0, 11462922661288872929, 705234877256492788, 15285067547267551823],
    [0, 8685523986883344813, 5189402771566872437, 13365870371239193017], 
    [0, 8691484281425062096, 12795630334971816194, 14801425411312727128], 
    [0, 3736235832881329480, 963362520841036787, 2425747491837933480], 
    [0, 1622722818849118758, 14755043213862161363, 13874178899784194194],
    [0, 3632717305838481192, 1214071339724279273, 9751709077147155499],
    [0, 13669617437297662519, 6110060895647374355, 3471925163867334933],
    [0, 16158453995329915075, 16765318684890845859, 8791236189902103374],
    [0, 4634727984228282364, 262259015920141319, 8826640880047261317],
    [0, 1589117574797907833, 953782989870186252, 3153682763919135176],
    [0, 17408595535725358576, 1246916769994843403, 13951244434621740654],
    [0, 14669817827077357355, 15304820503557575621, 7862176287495905405],
    [0, 13826258914807279454, 11209076148279190151, 26448026095026763], 
    [0, 11034525618811536398, 13888113278806122428, 14569381278722617385],
    [0, 12530655029540635044, 6793892545556219748, 18172314098722366665],
    [0, 14298642491616581458, 10954788128023082162, 13727665909253622461],
    [0, 745668369553588023, 7013162420860163092, 11006761376858914789], 
    [0, 10414598511333318548, 17267560392544836476, 15936562580257439990],
    [0, 7006531785942637488, 14560359703138467045, 18445347912108569150],
    [0, 17832013397205793368, 8267460749007099312, 14715435418032827703], 
    [0, 14833722001886878630, 12351490699278550218, 14502109663154771443],
    [0, 1583596717951030208, 17248805708277767730, 2916269679780750626],
    [0, 7358915110805147243, 7780761880636494827, 13012271822774676984], 
    [0, 17822699807347824378, 2276387032319463503, 14412694685856993128], 
    [0, 15379848971541347362, 4782424837802252869, 18257384685568861618],
    [0, 1437437257699243109, 13354908353672560208, 2688163757136230402], 
    [0, 14902729570033028431, 13321119784409744787, 7531814678345366155]
                     
];

pub fn gen_data() {
    let mut rng = rand::thread_rng();

    for i in 0..38 {
        let data: [u64; 4] = [0, rng.gen(), rng.gen(), rng.gen()];
        unsafe{ZOBRIST_HASH_DATA[i] = data};
    
    }

}

pub fn get_hash(board: &mut BoardState, current_player: f64) -> u64 {
    let mut hash = 0;

    if current_player == 1.0 {
        hash ^= PLAYER_1_HASH;
    } else {
        hash ^= PLAYER_2_HASH;

    }

    for i in 0..36 {
        if board.data[i] != 0 {
            let piece_type = board.data[i];
            unsafe{hash ^= ZOBRIST_HASH_DATA[i][piece_type]};

        }

    }

    return hash;

}

pub fn get_uni_hash(board: &mut BoardState) -> u64 {
    let mut hash = 0;

    for i in 0..36 {
        if board.data[i] != 0 {
            let piece_type = board.data[i];
            unsafe{hash ^= ZOBRIST_HASH_DATA[i][piece_type]};

        }

    }

    return hash;

}

